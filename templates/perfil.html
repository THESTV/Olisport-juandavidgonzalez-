<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Olisport Perfil" />
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.1/css/all.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style-responsive.css') }}" />
    <title>Mi Perfil - OliSport</title>
</head>
<body>

<!-- ===================== NAVBAR ===================== -->
<header>
    <nav class="navbar">
        <div class="nav-container">

            <!-- LOGO + ICONO CERRAR SESIÓN (IGUAL AL INDEX) -->
            <div class="logo-area">
                <a href="{{ url_for('index') }}" class="logo">
                    <img src="{{ url_for('static', filename='img/portfolio/logo-olisport.PNG') }}" alt="logo">
                </a>

                <div class="auth-icons">
                    {% if current_user.is_authenticated %}
                        <!-- CERRAR SESIÓN -->
                        <a href="{{ url_for('logout') }}" class="icon-btn" title="Cerrar sesión">
                            <i class="fas fa-sign-out-alt"></i>
                        </a>
                    {% else %}
                        <a href="{{ url_for('login') }}" class="icon-btn">
                            <i class="fas fa-user"></i>
                        </a>
                    {% endif %}
                </div>
            </div>

            <!-- MENÚ PRINCIPAL -->
            <ul class="nav-links">

                <li><a href="{{ url_for('index') }}">Inicio</a></li>

                <!-- MARKET -->
                <li><a href="{{ url_for('market') }}">Market</a></li>

                <!-- MI PERFIL (como estaba) -->
                {% if current_user.is_authenticated %}
                    <li><a href="{{ url_for('perfil') }}"class="current">Mi Perfil</a></li>
                {% endif %}

                <!-- PANELES -->
                {% if current_user.is_authenticated %}
                    {% if current_user.rol == 'trabajador' %}
                           <li>
              <a href="{{ url_for('panel_trabajador') }}">
                <i class="fas fa-tools"></i> 
              </a>
            </li>
                    {% endif %}

                    {% if current_user.rol == 'admin' %}
                         <li>
              <a href="{{ url_for('panel_trabajador') }}">
                <i class="fas fa-tools"></i> 
              </a>
            </li>
                          <li>
              <a href="{{ url_for('panel_admin') }}">
                <i class="fas fa-crown"></i>
              </a>
            </li>
                    {% endif %}
                {% endif %}
            </ul>

            <!-- HAMBURGUESA -->
            <div class="hamburger" id="hamburger">☰</div>

            <!-- MENÚ DESPLEGABLE -->
            <div class="hamburger-menu" id="hamburgerMenu">
                <a href="{{ url_for('about') }}">Quiénes somos</a>
                <a href="{{ url_for('servicio') }}">Servicios</a>
                <a href="{{ url_for('contact') }}">Contáctanos</a>
            </div>

            <hr />
        </div>
    </nav>
</header>

<!-- MENSAJES FLASH -->
<div class="flash-container">
    {% with messages = get_flashed_messages(with_categories=True) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="flash-message {{ category }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    {% endwith %}
</div>

<!-- ===================== PERFIL ===================== -->
<section class="perfil-unificado">

    <div class="perfil-card">

        <!-- FOTO / LOGO -->
        <div class="perfil-header">
            <img src="{{ url_for('static', filename='img/portfolio/logo-olisport.PNG') }}" class="perfil-avatar">
            <h2>{{ usuario.nombre }}</h2>
            <p class="perfil-correo">{{ usuario.correo }}</p>
        </div>

        <hr class="divider">

        <!-- FORMULARIO -->
        <form method="POST" class="perfil-form">

            <h3>Información Personal</h3>

            <label>Nombre completo</label>
            <input type="text" name="nombre" value="{{ usuario.nombre }}" required>

            <label>Correo electrónico</label>
            <input type="email" name="correo" value="{{ usuario.correo }}" required>

            <label>Número de celular</label>
            <input type="text" name="celular" value="{{ usuario.celular or '' }}">

            <label>Dirección</label>
            <input type="text" name="direccion" value="{{ usuario.direccion or '' }}">

            <label>Nueva contraseña (opcional)</label>
            <input type="password" name="password" placeholder="••••••••">

            <button class="btn-primary guardar-btn" type="submit">Guardar Cambios</button>
        </form>

    </div>

</section>

{% if redirect_market %}
<script>
    setTimeout(() => {
        window.location.href = "{{ url_for('market') }}";
    }, 3000);
</script>
{% endif %}

<!-- ===================== FOOTER ===================== -->
<footer class="main-footer">
    <p>&copy; 2025 OliSport — Todos los derechos reservados.</p>
    <div class="container">
        <p class="small">Catálogo 2025</p>
        <ul>
            <li><a href="#"><i class="fab fa-facebook"></i></a></li>
            <li><a href="#"><i class="fab fa-instagram"></i></a></li>
            <li><a href="#"><i class="fab fa-youtube"></i></a></li>
        </ul>
    </div>
</footer>

<!-- ===================== JS MENÚ HAMBURGUESA ===================== -->
<script>
    document.getElementById("hamburger").addEventListener("click", function () {
        const menu = document.getElementById("hamburgerMenu");
        menu.style.display = menu.style.display === "flex" ? "none" : "flex";
    });
</script>

</body>
</html>
